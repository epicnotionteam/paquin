document.addEventListener("DOMContentLoaded", function() {

    // Override native anchor link behavior
    function smoothScroll(event) {
        event.preventDefault();
        const targetId = this.getAttribute('href').substring(1);
        const targetElement = document.getElementById(targetId);
        if (targetElement) {
            const buffer = window.innerWidth <= 719 ? 56 : 72;
            window.scrollTo({
                top: targetElement.offsetTop - buffer,
                behavior: 'smooth'
            });
        }
    }
    // Attach smoothScroll function to all anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', smoothScroll);
    });
	
	// Append section theme to parent div (automatically generated by Shopify at page render)
  	// Facilitates sibling targeting to fix spacing on adjacent same-theme sections
  	var sections = document.querySelectorAll('#site-main section[class*="theme--"]');
  	sections.forEach(function(section) {
    	var parentDiv = section.closest('.shopify-section');
      	var themeClass = Array.from(section.classList).find(cls => cls.startsWith('theme--')).replace('theme--', 'section-theme--');
      	if (themeClass) {
          	parentDiv.classList.add(themeClass);
      	}
  	});

	// Accordion Component
    const accordions = document.querySelectorAll(".accordion");
    // Open accordion
    const openAccordion = (item) => {
        const content = item.querySelector(".item__content");
        item.classList.add("state--active");
        content.style.maxHeight = content.scrollHeight + "px";
    };
    // Close accordion
    const closeAccordion = (item) => {
        const content = item.querySelector(".item__content");
        item.classList.remove("state--active");
        content.style.maxHeight = null;
    };
    // Open/close active items
    accordions.forEach((accordion) => {
        const items = accordion.querySelectorAll(".item");
        // Open first item in each accordion
        if (items.length > 0) {
            openAccordion(items[0]);
        }
        items.forEach((item) => {
            const heading = item.querySelector(".item__heading");
            const content = item.querySelector(".item__content");
            heading.onclick = () => {
                if (item.classList.contains("state--active")) {
                    closeAccordion(item);
                } else {
                    items.forEach((otherItem) => {
                        if (otherItem !== item) {
                            closeAccordion(otherItem);
                        }
                    });
                    openAccordion(item);
                }
            };
        });
    });

});